Memory Search MVP â€” Milestone 1ï¼ˆèƒ½æœåˆ°ï¼‰éœ€æ±‚ä¸éªŒæ”¶æ–‡æ¡£
0. èƒŒæ™¯ä¸ç›®æ ‡

æœ¬é¡¹ç›®ç›®æ ‡æ˜¯åšä¸€ä¸ªæ¨¡ç³Šæœé¢˜ç³»ç»Ÿï¼šè€å¸ˆåªè®°å¾—é¢˜ç›®çš„â€œæ¨¡ç³Šå°è±¡â€ï¼ˆçŸ¥è¯†ç‚¹/æ–¹æ³•/æ„å‹/å…³é”®ä»£æ•°å¼/å¹´ä»½æ¥æºç­‰ï¼‰ï¼Œç³»ç»Ÿèƒ½åœ¨å‡ ç§’å†…è¿”å› Top-N å€™é€‰é¢˜ï¼Œå¹¶å¯¹æ¯æ¡ç»“æœå±•ç¤ºâ€œå‘½ä¸­è¯æ®â€ï¼Œæ”¯æŒ ğŸ‘/ğŸ‘ åé¦ˆã€‚

Milestone 1ï¼ˆèƒ½æœåˆ°ï¼‰ç›®æ ‡ï¼š
å…ˆæŠŠâ€œå¯ç”¨é—­ç¯â€åšå‡ºæ¥ï¼šå½•é¢˜/ç¼–è¾‘ â†’ ç”Ÿæˆå¯æ£€ç´¢è§†å›¾ â†’ æœç´¢ â†’ è¯æ®å±•ç¤º â†’ åé¦ˆè®°å½•ã€‚

å£å·ï¼šå…ˆé€šï¼Œå†å‡†ï¼Œå†çˆ½
æœ¬é‡Œç¨‹ç¢‘åªåš â€œå…ˆé€šâ€ã€‚

1. é‡Œç¨‹ç¢‘èŒƒå›´ï¼ˆScopeï¼‰
1.1 å¿…åšåŠŸèƒ½ï¼ˆMust-haveï¼‰

é¢˜ç›®ç®¡ç†ï¼ˆItemsï¼‰

åˆ›å»ºé¢˜ç›®ï¼šä¿å­˜é¢˜å¹²/æ–¹æ³•é“¾/å›¾åƒæè¿°/è§£é¢˜æçº²/æ‰¹æ³¨/æ ‡ç­¾/meta

ä¿®æ”¹é¢˜ç›®ï¼šæ›´æ–°ä¸Šè¿°å­—æ®µ

æŸ¥çœ‹é¢˜ç›®ï¼šè¯»å–é¢˜ç›®è¯¦æƒ…ï¼ˆæ–¹ä¾¿è°ƒè¯•ä¸ç¼–è¾‘ï¼‰

æ£€ç´¢ï¼ˆSearchï¼‰

è¾“å…¥ queryï¼ˆæ¨¡ç³Šæè¿°ï¼‰ï¼Œè¿”å› Top-N é¢˜ç›®

æ”¯æŒæœ€å° meta è¿‡æ»¤ï¼ˆå»ºè®®ï¼šgrade/sourceï¼›å¯æ‰©å±•åˆ° province/year ç­‰ï¼‰

æ¯æ¡ç»“æœå¿…é¡»è¿”å›è¯æ®ç‰‡æ®µï¼ˆevidence snippetsï¼‰ï¼Œæ ‡æ³¨å‘½ä¸­çš„è§†å›¾ç±»å‹ï¼ˆmethod/note/problem/diagram/solution_outlineï¼‰

åé¦ˆï¼ˆFeedbackï¼‰

å¯¹æŸæ¬¡æŸ¥è¯¢ä¸­çš„æŸä¸ªé¢˜ç›®ç‚¹èµ/ç‚¹è¸©ï¼ˆvote=+1/-1ï¼‰ï¼Œå¯é€‰ reason

è®°å½•åˆ°æ•°æ®åº“ï¼ˆåç»­ç”¨äºè°ƒå‚/å­¦ä¹ æ’åºï¼‰

1.2 æ˜ç¡®ä¸åšï¼ˆNon-goalsï¼‰

OCR å›¾ç‰‡è¯†åˆ«

LLM è‡ªåŠ¨æ‰“æ ‡ / QueryPlan

Embedding å‘é‡æ£€ç´¢ä¸é‡æ’ï¼ˆrerankï¼‰

å¤æ‚æƒé™/è´¦å·ç³»ç»Ÿ

å¤šç§Ÿæˆ·/å­¦æ ¡çº§éš”ç¦»

å¤æ‚ UIï¼ˆæœ¬é˜¶æ®µ UI æœ´ç´ å³å¯ï¼‰

2. ç”¨æˆ·æ•…äº‹ï¼ˆUser Storiesï¼‰

è€å¸ˆè¾“å…¥ï¼šâ€œæµ™æ±Ÿ2019è§£æå‡ ä½•å‹è½´ï¼Œåˆ†å¼å‡½æ•°æœ€å€¼ï¼Œå›¾é‡Œæœ‰é‡å¿ƒâ€
â†’ ç³»ç»Ÿè¿”å› Top10ï¼Œè‡³å°‘ Top3 å†…èƒ½å‡ºç°ç›®æ ‡é¢˜æˆ–éå¸¸æ¥è¿‘çš„å€™é€‰ã€‚

è€å¸ˆç‚¹å¼€ç»“æœå¡ç‰‡èƒ½çœ‹åˆ°ï¼š

å‘½ä¸­çš„ evidence ç‰‡æ®µï¼ˆä¾‹å¦‚ method_chain / user_notesï¼‰

é«˜äº®å‘½ä¸­è¯ï¼ˆå¯é€‰ï¼‰

è€å¸ˆå¯¹ç»“æœç‚¹ ğŸ‘ æˆ– ğŸ‘ï¼Œç³»ç»Ÿè®°å½•ä¸‹æ¥ä¾›åç»­ä¼˜åŒ–ã€‚

3. æŠ€æœ¯æ¶æ„ï¼ˆMilestone 1ï¼‰
3.1 æŠ€æœ¯é€‰å‹

åç«¯ï¼šFastAPIï¼ˆåŒæ­¥å³å¯ï¼‰

DBï¼šPostgres + pgvector é•œåƒï¼ˆæœ¬é˜¶æ®µä¸»è¦ç”¨ Postgres FTSï¼Œä¸ç”¨å‘é‡ä¹Ÿæ²¡å…³ç³»ï¼‰

å‰ç«¯ï¼šNext.jsï¼ˆåªéœ€è¦æœ€ç®€æœç´¢é¡µ + ç»“æœå¡ç‰‡ + åé¦ˆæŒ‰é’®ï¼‰

3.2 æ ¸å¿ƒæ•°æ®æ€æƒ³

problem_itemsï¼šé¢˜ç›®çš„â€œä¸»æ¡£æ¡ˆâ€ï¼ˆä¸€é¢˜ä¸€è¡Œï¼‰

search_viewsï¼šé¢˜ç›®çš„â€œæ£€ç´¢è§†å›¾â€ï¼ˆä¸€é¢˜å¤šè§†è§’ï¼šproblem/method/note/diagram/solution_outlineï¼‰

æœç´¢å‘½ä¸­çš„æ˜¯ search_viewsï¼Œä½†è¿”å›/å±•ç¤ºçš„æ˜¯ problem_items

å…³é”®ï¼šå‘½ä¸­ viewï¼Œèšåˆå› itemã€‚

4. æ•°æ®åº“ç»“æ„ï¼ˆMilestone 1 å¿…éœ€è¡¨ï¼‰
4.1 å¿…éœ€æ‰©å±•ä¸ç±»å‹

pgcryptoï¼šç”Ÿæˆ UUID

vectorï¼šé¢„ç•™ï¼ˆMilestone 2 ç”¨ï¼‰

view_type enumï¼šé™å®šè§†å›¾ç±»å‹

4.2 å¿…éœ€è¡¨

problem_items

idï¼šUUID ä¸»é”®

imagesï¼šJSONBï¼ˆå…ˆå­˜è·¯å¾„å­—ç¬¦ä¸²æ•°ç»„ï¼‰

problem_textï¼šé¢˜å¹²

diagram_descï¼šå›¾åƒ/å‡ ä½•æ„å‹æè¿°

method_chainï¼šæ–¹æ³•é“¾ï¼ˆæ£€ç´¢æ ¸å¿ƒèµ„äº§ï¼‰

solution_outlineï¼šè§£é¢˜æçº²

user_notesï¼šè€å¸ˆæ‰¹æ³¨

user_tagsï¼šæ–‡æœ¬æ•°ç»„æ ‡ç­¾

metaï¼šJSONB å…ƒæ•°æ®ï¼ˆgrade/source/province/yearâ€¦ï¼‰

bm25_textï¼šæ‹¼æ¥æ–‡æœ¬ï¼ˆæ£€ç´¢/å…œåº•ï¼‰

ftsï¼šTSVECTORï¼ˆç”± bm25_text ç”Ÿæˆï¼‰

search_views

item_idï¼šå¤–é”®æŒ‡å‘ problem_items

view_typeï¼šæšä¸¾

textï¼šè¯¥è§†å›¾æ–‡æœ¬

ftsï¼šTSVECTORï¼ˆç”± text ç”Ÿæˆï¼‰

çº¦æŸï¼šUNIQUE(item_id, view_type)ï¼ˆç”¨äº upsertï¼‰

feedback

query_idï¼šUUIDï¼ˆæœç´¢è¿”å›çš„ query_idï¼‰

item_idï¼šUUIDï¼ˆé¢˜ç›®ï¼‰

voteï¼š+1/-1

reasonï¼šå¯é€‰

tsï¼šæ—¶é—´æˆ³

5. API å¥‘çº¦ï¼ˆMilestone 1ï¼‰
5.1 Items
POST /v1/items

åˆ›å»ºé¢˜ç›®ã€‚æœåŠ¡ç«¯å¿…é¡»ï¼š

å†™å…¥ problem_items

upsert å†™å…¥ 5 æ¡ search_views

é‡ç®— bm25_text

Requestï¼ˆJSONï¼‰ï¼š

{
  "problem_text":"...",
  "diagram_desc":"...",
  "method_chain":"è®¾å‚â†’å¯¼æ•°â†’éŸ¦è¾¾â†’æœ€å€¼",
  "solution_outline":"...",
  "user_notes":"...",
  "user_tags":["è§£æå‡ ä½•","æœ€å€¼","é‡å¿ƒ"],
  "meta":{"province":"æµ™æ±Ÿ","year":"2019","source":"çœŸé¢˜"},
  "images":[]
}


Responseï¼ˆJSONï¼‰ï¼š

{
  "id":"<uuid>",
  "problem_text":"...",
  "diagram_desc":"...",
  "method_chain":"...",
  "solution_outline":"...",
  "user_notes":"...",
  "user_tags":["..."],
  "meta":{"..."},
  "images":[]
}

PATCH /v1/items/{item_id}

æ›´æ–°é¢˜ç›®ï¼ˆpartial updateï¼‰ã€‚æœåŠ¡ç«¯å¿…é¡»ï¼š

æ›´æ–° problem_items

åŒæ­¥ upsert search_views

é‡ç®— bm25_text

GET /v1/items/{item_id}

è¯»å–é¢˜ç›®è¯¦æƒ…ï¼ˆç”¨äºè°ƒè¯•/ç¼–è¾‘ï¼‰ã€‚

5.2 Search
POST /v1/search

Milestone 1 ä»…ä½¿ç”¨ search_views FTS æ£€ç´¢ï¼Œè¿”å›è¯æ®ç‰‡æ®µã€‚æ”¯æŒæœ€å° meta_filtersã€‚

Requestï¼š

{
  "query":"æµ™æ±Ÿ2019 è§£æå‡ ä½• æœ€å€¼ é‡å¿ƒ åˆ†å¼ éŸ¦è¾¾",
  "top_n":10,
  "meta_filters":{"grade":"é«˜ä¸­","source":"çœŸé¢˜"}
}


Responseï¼š

{
  "query_id":"<uuid>",
  "results":[
    {
      "item_id":"<uuid>",
      "title":"é¢˜å¹²å‰è‹¥å¹²å­—...",
      "score":0.82,
      "evidence":[
        {"view_type":"method","snippet":"...","rank":0.73},
        {"view_type":"note","snippet":"...","rank":0.44}
      ],
      "user_tags":["..."],
      "images":[]
    }
  ]
}

5.3 Feedback
POST /v1/feedback

å†™å…¥ç‚¹èµ/ç‚¹è¸©è®°å½•ã€‚

Requestï¼š

{
  "query_id":"<uuid>",
  "item_id":"<uuid>",
  "vote":1,
  "reason":"å‘½ä¸­æ–¹æ³•é“¾"
}


Responseï¼š

{"ok": true, "feedback_id": 1}

6. UIï¼ˆMilestone 1 æœ€å°å‰ç«¯ï¼‰

åªéœ€ä¸€ä¸ªæœç´¢é¡µå³å¯ï¼š

6.1 æœç´¢é¡µ /

è¾“å…¥æ¡†ï¼ˆqueryï¼‰

è¿‡æ»¤å™¨ï¼ˆå¯é€‰ï¼šgrade/sourceï¼‰

æœç´¢æŒ‰é’®

ç»“æœåˆ—è¡¨ï¼ˆResultCardï¼‰

6.2 ç»“æœå¡ç‰‡ ResultCard

titleï¼ˆé¢˜å¹²æˆªæ–­ï¼‰

evidence snippetsï¼ˆè‡³å°‘ 1~3 æ¡ï¼‰

ğŸ‘/ğŸ‘ æŒ‰é’®ï¼ˆè°ƒç”¨ /v1/feedbackï¼‰

7. å®ç°æ­¥éª¤ï¼ˆå»ºè®®æŒ‰é¡ºåºï¼‰

DBï¼šdocker å¯åŠ¨ + æ‰§è¡Œ init.sql å»ºè¡¨

åç«¯ï¼šç¡®ä¿ /healthz ä¸ /docs å¯è®¿é—®

Itemsï¼šå®ç° POST/PATCH/GETï¼Œç¡®ä¿ä¼š upsert search_views

Searchï¼šFTS æŸ¥è¯¢ search_viewsï¼Œèšåˆè¯æ®å› item

Feedbackï¼šå†™å…¥ feedback è¡¨

å‰ç«¯ï¼šæœ€ç®€æœç´¢é¡µ + ç»“æœå¡ç‰‡ + åé¦ˆæŒ‰é’®

å½•å…¥ 20~50 é“é¢˜è¿›è¡ŒéªŒè¯

8. éªŒæ”¶æ ‡å‡†ï¼ˆDefinition of Doneï¼‰

å®Œæˆä»¥ä¸‹æ¼”ç¤ºå³é€šè¿‡ï¼š

Demo Scriptï¼ˆå¯å¤åˆ¶æ¼”ç¤ºï¼‰

åˆ›å»ºé¢˜ç›®ï¼ˆcurl POST /itemsï¼‰â†’ è¿”å› item_id

æœç´¢ï¼ˆcurl POST /searchï¼‰â†’ è¿”å›åŒ…å«è¯¥é¢˜çš„ resultsï¼Œä¸”æœ‰ evidence snippets

ç‚¹èµï¼ˆcurl POST /feedbackï¼‰â†’ è¿”å› ok

psql æŸ¥è¯¢ feedback â†’ èƒ½çœ‹åˆ°è®°å½•

æ•°æ®è´¨é‡æœ€ä½è¦æ±‚

search_views ä¸­æ¯é“é¢˜è‡³å°‘æœ‰ method / problem ä¸¤ç±»è§†å›¾ï¼ˆå»ºè®® 5 ç±»é½å…¨ï¼‰

ä¿®æ”¹é¢˜ç›®åï¼Œç«‹å³èƒ½ç”¨æ–°å†…å®¹æœåˆ°ï¼ˆè¯´æ˜ views åŒæ­¥æ›´æ–°æˆåŠŸï¼‰

9. æœªæ¥é‡Œç¨‹ç¢‘ï¼ˆä»…å¤‡æ³¨ï¼‰

Milestone 2ï¼ˆæœå¾—å‡†ï¼‰ï¼šQueryPlan + å‘é‡å¬å› + meta æ›´ä¸°å¯Œ + è¯„æµ‹æŒ‡æ ‡

Milestone 3ï¼ˆæœå¾—çˆ½ï¼‰ï¼šchips äº¤äº’ã€rerankã€è®²è§£ç”Ÿæˆã€è¯­éŸ³åŠ©æ‰‹ï¼ˆå¯é€‰ï¼‰

10. é¡¹ç›®ç»“æ„ï¼ˆå½“å‰çº¦å®šï¼‰
backend/app/
  main.py
  api/v1/
    routes_items.py
    routes_search.py
    routes_feedback.py
  schemas/
  services/
  db/
    engine.py
  core/
    config.py
  utils/
frontend/
  src/pages/index.tsx
  src/components/ResultCard.tsx
db/
  init.sql
docker-compose.yml


å¦‚æœä½ å¸Œæœ›æˆ‘æŠŠè¿™ä»½æ–‡æ¡£åŒæ­¥è¾“å‡ºä¸€ä¸ª LaTeX ç‰ˆæœ¬ï¼ˆ.texï¼‰ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç›´æ¥ç»™ä½ ä¸€ä¸ªå¯ç¼–è¯‘çš„ TeXï¼ˆé€‚åˆå†™è¿›é¡¹ç›®æ–‡æ¡£/è®ºæ–‡é™„å½•ï¼‰ã€‚ä½ æ›´æƒ³è¦ Markdown è¿˜æ˜¯ TeXï¼Ÿ